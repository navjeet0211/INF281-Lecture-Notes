%\documentclass[12pt]{article}
%\usepackage[a4paper, margin=1in]{geometry} 
%\usepackage{graphicx} 
%\usepackage{hyperref}
%\usepackage{float}
%\usepackage{multicol}
%\usepackage{multirow}
%\usepackage{amsmath}
%\usepackage[font=small, labelfont=bf]{caption}
%
%\begin{document}

%
% Pattern comparison
%
\subsection{Pattern comparison}
Information theory is used to score a pattern. Calculated scores indicate the specificity of patterns.

%
% Information theory for amino acid distribution
%
\subsubsection*{Information theory for amino acid distribution}
$I(a)$ represents the information content of amino acid $a$ when the probability of $a$ is $p_a$. 

\[
I(a) = -\log⁡ p_a
\]

\noindent
$H(M)$ represents the entropy of all amino acids.

\[
H(M) = -\sum_{a \in M}p_a \log⁡ p_a
\]

%
% Example of entropy calculation 
%
\subsubsection*{Example of entropy calculation }
Calculate the information content of an amino acid A when p(A) = 0.25. Use base 2.

\begin{align*}
I(a) = -\log⁡ p_a = -1 \times -2 = 2
\end{align*}

\noindent
Calculate the entropy of $M$ that contains three pseudo amino acids A, B, C with the probabilities $p(\mathrm{A})=1/2$, $p(\mathrm{B})=1/4$, and $p(\mathrm{C})=1/4$. 

\begin{align*}
H(M) &= -p(\mathrm{A}) \cdot \log⁡ p(\mathrm{A}) - p(\mathrm{B})  \cdot  \log ⁡p(\mathrm{B} ) - p(\mathrm{C})  \cdot  \log⁡ p(\mathrm{C}) \\
 & = (-0.5) \times (-1) + (-0.25) \times (-2) + (-0.25) \times (-2) = 1.5
\end{align*}

%
% Scores of pattern specificity
%
\subsubsection*{Scores of patterns}
Patterns can be scored for their specificity. 

\noindent
$p\prime_{ai}$ represents an adjusted probability of $a$ at position $i$.

\begin{align*}
p'_{ai} = \dfrac{p_a}{\sum_{b \in K_i} p_b} 
\end{align*}

\noindent
$I'_{K_i}$ represents the information content of a set of amino acids $K_i$ at position $i$. 

\[
I'(K_i) = H(M) - \left (-\sum_{a_i \in K_i}  p'_{a_i} \log⁡ p'_{a_i} \right )	
\]

\noindent
The information content of a pattern P can be the sum of $I'_{K_i}$ for all $i$.

\begin{align*}
I(P)=\sum_{i} I'(K_i) - c \sum_{k} (j_k - i_k)	
\end{align*}

\begin{center}
where $c$ is a constant value for a wildcard region $x(j_k - i_k)$.
\end{center}

%
% Example of pattern specificity scores
%
\subsubsection*{Example of pattern specificity scores}
Calculate the information content of the following patterns when the probabilities of the pseudo amino acids are $p(A)=1/2$, $p(B)=1/4$, and $p(C)=1/4$. Use $c = 0.1$. \\

$\mathbf{P_1:}$ \verb|A - B|
\begin{align*}
I'(K_1) &= 1.5 - (-1 \log⁡1) = 1.5 \\
I'(K_2) &= 1.5 - (-1 \log⁡1) = 1.5 \\ \\
I(P_1) &= 1.5 + 1.5 = 3
\end{align*}

$\mathbf{P_2:}$ \verb|[AC] - B|
\begin{align*}
p'_{A1} &= \dfrac{1/2}{(1/2+1/4)} = \dfrac{1/2}{3/4} = \dfrac{2}{3} \\
p'_{C1} &= \dfrac{1/4}{(1/2+1/4)} = \dfrac{1/4}{3/4} = \dfrac{1}{3} \\ \\
I'(K_1) &= 1.5 - \left (-\dfrac{2}{3} \log⁡ \dfrac{2}{3} \right) -  \left (-\dfrac{1}{3} \log⁡ \dfrac{1}{3} \right)  \\
 &= 1.5 + \dfrac{2}{3} ( 1 - \log⁡3) - \dfrac{2}{3}  \log⁡3 \\
 &=\dfrac{13}{6} - \log3 \\ \\
I'(K_2) &= 1.5 - (-1 \log⁡1) = 1.5 \\ \\
I(P_2) &= 1.5 + \dfrac{13}{6} - \log3 = \dfrac{22}{6} - \log3 = 2.817
\end{align*}

$\mathbf{P_3:}$ \verb|A - B - x(1, 2)|
\begin{align*}
I(P_3) &= 3 - 0.1 \times (2 - 1) = 2.9
\end{align*}

\bigskip 

%\end{document}
